import mnist_loader
import network
import json


def run():
    layers = [784, 16, 16, 10]
    learn = True
    training_data, validation_data, test_data = mnist_loader.load_data_wrapper()
    if(not(learn)):
        with open("data.json") as f: data = json.load(f)
        net = network.Network(layers, data=data)

    if(learn):
        net = network.Network(layers)
        net.StochasticGradientDescent(training_data, 30, 20, 2.0, test_data=test_data)
        exportData = {"weights": [net.weights[i].tolist() for i in range(len(layers) - 1)], "biases": [net.biases[i].tolist() for i in range(len(layers) - 1)]}
        jsonString = json.dumps(exportData, indent=4, ensure_ascii=False)
        jsonFile = open("data.json", "w")
        jsonFile.write(jsonString)
        jsonFile.close()
    print(net.recognising([
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        0.5
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0.5
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.5
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0.5
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        0.75
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.25
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0.25
    ],
    [
        0.5
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        1
    ],
    [
        0.75
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ],
    [
        0
    ]
]))
if __name__ == '__main__':
    run()
